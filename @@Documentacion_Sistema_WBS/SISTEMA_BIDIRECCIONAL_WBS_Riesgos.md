# SISTEMA BIDIRECCIONAL WBS ‚Üî RIESGOS ‚Üî TERMINAL
## Integraci√≥n Completa para Gesti√≥n de Cambios

**Proyecto:** APP La Dorada-Chiriguan√°  
**Fecha:** 7 de Octubre de 2025  
**Versi√≥n:** 1.0  

---

## üéØ **CONCEPTO: SISTEMA BIDIRECCIONAL**

### **Flujo 1: Usuario Final ‚Üí Sistema**
```
Usuario en WBS Interactiva
    ‚Üì
Propone cambio (ej: cajas 300m ‚Üí 500m)
    ‚Üì
Sistema analiza TODO:
- ‚úÖ Criterios t√©cnicos (norma, acceso, fallas, costo)
- ‚úÖ Impacto en otros √≠tems WBS
- ‚úÖ Riesgos nuevos/modificados
- ‚úÖ Archivos afectados
- ‚úÖ Recomendaci√≥n fundamentada
    ‚Üì
Usuario aprueba
    ‚Üì
Sistema ejecuta cambios en I-VI
```

### **Flujo 2: Terminal/PMO ‚Üí Interfaz**
```
PMO actualiza riesgo en terminal
    ‚Üì
Modifica: VIII/Matrices_Dependencias/MATRIZ_RIESGOS_PMO_AMPLIADA_v1.0.md
    ‚Üì
Sistema detecta cambio (auto-refresh o manual)
    ‚Üì
WBS Interactiva recarga riesgos
    ‚Üì
Usuario ve riesgos actualizados en interfaz
```

---

## üìä **QU√â ANALIZA LA INTERFAZ (TODO, NO SOLO RIESGOS)**

### **1. AN√ÅLISIS DE CRITERIOS T√âCNICOS** ‚úÖ

**Tabla generada autom√°ticamente:**
| Criterio | Valor Actual | Valor Propuesto | Cumplimiento | Observaciones |
|:---------|:-------------|:----------------|:-------------|:--------------|
| Norma UIT-T | 300m | 500m | ‚úÖ Cumple | Dentro de l√≠mite |
| Acceso vehicular | ‚ùå Dif√≠cil | ‚úÖ Mejorado | ‚úÖ Bueno | Mejor acceso mantenimiento |
| Localizaci√≥n fallas | ‚úÖ R√°pida | ‚è±Ô∏è +66% tiempo | ‚ö†Ô∏è Aceptable | Aumento moderado |
| Costo-efectividad | ‚ùå Alto CAPEX | ‚úÖ Mejora 42.5% | ‚úÖ Excelente | Reducci√≥n significativa |

**Fuentes consultadas:**
- `CRITERIOS_TECNICOS_MAESTRO_v1.0.md` - Criterios maestros
- Normas UIT-T, RETIE, est√°ndares ferroviarios
- Documentos t√©cnicos en III/ y V/

---

### **2. AN√ÅLISIS DE IMPACTO EN OTROS √çTEMS WBS** ‚úÖ

**Tabla generada autom√°ticamente:**
| √çtem WBS | Descripci√≥n | Cant. Actual | Cant. Nueva | Œî Costo |
|:---------|:------------|:-------------|:------------|:--------|
| 2.3.104 | Uniones r√°pidas (3 √ó cajas) | 6,204 | 3,564 | -$92,400,000 |
| 2.3.108 | Insumos fusionado (3.2 √ó cajas) | 6,600 | 3,780 | -$42,300,000 |
| **TOTAL IMPACTO** | | | | **-$134,700,000** |

**C√°lculo:** Sistema identifica √≠tems vinculados y recalcula autom√°ticamente

---

### **3. AN√ÅLISIS DE RIESGOS DETALLADO** ‚úÖ

**Por cada alternativa:**

**Alternativa 1 (300m - Actual):**
| Riesgo | Prob | Impacto | Estrategia |
|:-------|:-----|:--------|:-----------|
| R-FIBRA-003 (CAPEX alto) | Alta | Alto | Aceptar |
| R-FIBRA-008 (Acceso vehicular) | Media | Medio | Aceptar |

**Alternativa 2 (500m - Propuesta):**
| Riesgo | Prob | Impacto | Estrategia |
|:-------|:-----|:--------|:-----------|
| R-FIBRA-003 (CAPEX) | Baja | Alto | Mitigado |
| R-FIBRA-006 (Localizaci√≥n fallas) | Baja | Medio | Aceptar |
| R-FIBRA-008 (Acceso) | Baja | Bajo | Mitigado |

**Alternativa 3 (1000m - Agresiva):**
| Riesgo | Prob | Impacto | Estrategia |
|:-------|:-----|:--------|:-----------|
| R-FIBRA-006 (Localizaci√≥n fallas) | Media | Alto | Mitigar con OTDR |
| R-FIBRA-007 (Degradaci√≥n se√±al) | Media | Medio | Mitigar con validaci√≥n |

**Fuente:** Riesgos cargados desde `MATRIZ_RIESGOS_PMO_AMPLIADA_v1.0.md`

---

### **4. ARCHIVOS QUE SE ACTUALIZAR√ÅN** ‚úÖ

**Consultado autom√°ticamente de MATRIZ_DEPENDENCIAS:**
| Archivo | Ubicaci√≥n | Secci√≥n | Tipo Cambio | Versi√≥n |
|:--------|:----------|:--------|:------------|:--------|
| V.3_Sistemas_Comunicacion_Detalle.md | Carpetas I-VI | Tabla 5.3 | Cantidades | v2.0 ‚Üí v2.1 |
| WBS_Presupuestal_v3.0.md | Carpetas I-VI | Item 2.3.103 | Costos | Recalculado |
| IV/37_Memorias_Diseno_Basico.md | Carpetas I-VI | Secci√≥n 4.2.3 | Especificaciones | v5.0 ‚Üí v5.1 |
| III/28_Sistema_FibraOptica_Integrado.md | Carpetas I-VI | Secci√≥n 2.2 | Criterios | v5.0 ‚Üí v5.1 |
| X/SISTEMA_02_Telecomunicaciones_Master.md | Carpeta X | Secci√≥n 5.2.3 | Consolidado | ‚è≥ Snapshot mensual |

---

### **5. COMPARATIVA DE ALTERNATIVAS** ‚úÖ

**3 Alternativas con puntaje calculado:**
- Alternativa 1: 300m - Puntaje 7.2/10
- **Alternativa 2: 500m - Puntaje 8.5/10** ‚≠ê RECOMENDADA
- Alternativa 3: 1000m - Puntaje 6.8/10

**Matriz de decisi√≥n (pesos):**
- Costo CAPEX: 30%
- Cumplimiento t√©cnico: 25%
- Facilidad construcci√≥n: 20%
- Mantenibilidad: 15%
- Riesgo t√©cnico: 10%

---

### **6. RECOMENDACI√ìN DEL SISTEMA** ‚úÖ

```
üéØ RECOMENDACI√ìN: ‚úÖ APROBAR ALTERNATIVA 2 (500m)

Puntaje: 8.5/10
Ahorro: $1,188,000,000 COP (42.5%)

Justificaci√≥n:
‚úÖ Cumple norma UIT-T estrictamente
‚úÖ Balance √≥ptimo entre ahorro y riesgo
‚úÖ Riesgos manejables (2 identificados)
‚úÖ Ahorro significativo en CAPEX

Condiciones:
üìù Actualizar CRITERIOS_TECNICOS_MAESTRO
‚ö†Ô∏è Agregar 2 riesgos a MATRIZ_RIESGOS_PMO
üìÅ Actualizar 5 archivos en carpetas I-VI
```

---

## üîÑ **SISTEMA BIDIRECCIONAL: TERMINAL ‚Üí INTERFAZ**

### **Caso de Uso: PMO actualiza riesgo desde terminal**

**PASO 1: PMO edita matriz de riesgos**
```bash
# Terminal/Editor
Archivo: VIII/Matrices_Dependencias/MATRIZ_RIESGOS_PMO_AMPLIADA_v1.0.md

CAMBIO:
Agregar nuevo riesgo:
| R-FIBRA-009 | T√©cnico | Validaci√≥n OTDR no realizada | Alta | Alto | Mitigar | Ing. Fibra | Activo | Validaci√≥n | DT-FIBRA-001 | H-FIBRA-005 |

Guardar archivo
```

**PASO 2: Sistema detecta cambio**
```javascript
// En WBS_Presupuestal_INTERACTIVA_v3.0.html

Opci√≥n A: Auto-refresh cada 30 segundos
setInterval(recargarRiesgosDesdeMatriz, 30000);

Opci√≥n B: Bot√≥n manual "üîÑ Actualizar Riesgos"
Click en bot√≥n ‚Üí Lee archivo ‚Üí Actualiza interfaz
```

**PASO 3: Interfaz actualiza riesgos**
```javascript
function recargarRiesgosDesdeMatriz() {
    // Leer archivo: MATRIZ_RIESGOS_PMO_AMPLIADA_v1.0.md
    // Filtrar riesgos donde campo "Relacionado_Item_WBS" === "2.3.103"
    // o donde "Origen_Decisi√≥n" === "DT-FIBRA-001"
    
    // Actualizar div #riesgos-2-3-103
    const divRiesgos = document.getElementById('riesgos-2-3-103');
    divRiesgos.innerHTML = `
        <h4>‚ö†Ô∏è Riesgos Asociados: 4 (Actualizado üîÑ)</h4>
        [Riesgos recargados desde matriz]
        - R-FIBRA-003
        - R-FIBRA-006
        - R-FIBRA-008
        - R-FIBRA-009 ‚≠ê NUEVO
    `;
}
```

**PASO 4: Usuario ve cambio**
```
Usuario en WBS Interactiva
    ‚Üì
Ve riesgo R-FIBRA-009 aparecer autom√°ticamente
    ‚Üì
Contador cambia: "3 riesgos" ‚Üí "4 riesgos" üîÑ
    ‚Üì
Riesgo nuevo visible con badge "NUEVO"
```

---

## üõ†Ô∏è **IMPLEMENTACI√ìN T√âCNICA**

### **Archivo JSON Intermedio (Generado desde Matriz)**

**Crear:** `riesgos_item_2-3-103.json`

```json
{
  "item_wbs": "2.3.103",
  "ultima_actualizacion": "2025-10-07T15:30:00",
  "riesgos": [
    {
      "id": "R-FIBRA-003",
      "descripcion": "Espaciamiento muy corto aumenta CAPEX",
      "probabilidad": "Alta",
      "impacto": "Alto",
      "estrategia": "Analizar 500m-1000m",
      "responsable": "PMO",
      "estado": "Activo",
      "origen_decision": "N/A",
      "hito_verificacion": "N/A"
    },
    {
      "id": "R-FIBRA-006",
      "descripcion": "Reducir cajas puede aumentar tiempo localizaci√≥n fallas",
      "probabilidad": "Baja",
      "impacto": "Medio",
      "estrategia": "Aceptar si > 500m",
      "responsable": "Ing. Fibra",
      "estado": "Activo",
      "origen_decision": "DT-FIBRA-001",
      "hito_verificacion": "H-FIBRA-005"
    },
    {
      "id": "R-FIBRA-008",
      "descripcion": "Acceso a cajas cada 300m dificulta mantenimiento vehicular",
      "probabilidad": "Media",
      "impacto": "Medio",
      "estrategia": "Considerar 500m-1000m",
      "responsable": "Construcci√≥n",
      "estado": "Activo",
      "origen_decision": "N/A",
      "hito_verificacion": "N/A"
    }
  ]
}
```

**Generado por script:** `scripts/generar_json_riesgos.ps1`

---

### **Script PowerShell para Sincronizaci√≥n**

**Crear:** `scripts/sincronizar_riesgos_wbs.ps1`

```powershell
# Script para convertir MATRIZ_RIESGOS_PMO_AMPLIADA a JSON
# Se ejecuta cada vez que se actualiza la matriz

$matrizPath = "VIII. Documentos Maestros y Metodologia/Matrices_Dependencias/MATRIZ_RIESGOS_PMO_AMPLIADA_v1.0.md"
$outputPath = "IX. WBS y Planificacion/riesgos_cache/"

# Leer matriz de riesgos
$contenido = Get-Content $matrizPath -Raw

# Extraer riesgos relacionados con cada √≠tem WBS
# Parsear tabla Markdown
# Generar JSON por √≠tem WBS

# Ejemplo output:
# riesgos_item_2-3-103.json
# riesgos_item_3-1-100.json
# etc.

Write-Host "‚úÖ Riesgos sincronizados para WBS Interactiva"
```

---

### **JavaScript en WBS para Cargar Riesgos**

```javascript
// En WBS_Presupuestal_INTERACTIVA_v3.0.html

async function recargarRiesgosDesdeMatriz(itemId) {
    try {
        // Opci√≥n 1: Cargar desde JSON generado
        const response = await fetch(`riesgos_cache/riesgos_item_${itemId.replace('.', '-')}.json`);
        const data = await response.json();
        
        // Actualizar div de riesgos
        const divRiesgos = document.getElementById(`riesgos-${itemId}`);
        divRiesgos.innerHTML = `<h4>‚ö†Ô∏è Riesgos Asociados: ${data.riesgos.length} (Actualizado: ${new Date(data.ultima_actualizacion).toLocaleString('es-CO')})</h4>`;
        
        data.riesgos.forEach(riesgo => {
            const div = document.createElement('div');
            div.className = 'riesgo-item';
            div.innerHTML = `
                <div>
                    <strong>${riesgo.id}:</strong> ${riesgo.descripcion}
                    ${riesgo.estado === 'Nuevo' ? '<span class="riesgo-badge riesgo-alto">NUEVO</span>' : ''}
                </div>
                <div>
                    <span class="riesgo-badge riesgo-${riesgo.probabilidad.toLowerCase()}">${riesgo.probabilidad} Prob</span>
                    <span class="riesgo-badge riesgo-${riesgo.impacto.toLowerCase()}">${riesgo.impacto} Impacto</span>
                </div>
            `;
            divRiesgos.appendChild(div);
        });
        
        // Notificar al usuario
        if (data.riesgos.some(r => r.estado === 'Nuevo')) {
            mostrarNotificacion('üîî Nuevos riesgos agregados desde terminal', 'info');
        }
        
    } catch (error) {
        console.error('Error cargando riesgos:', error);
        
        // Fallback: Mostrar mensaje
        alert('‚ö†Ô∏è No se pudieron cargar riesgos actualizados.\n\nAseg√∫rate de ejecutar:\nscripts/sincronizar_riesgos_wbs.ps1');
    }
}

// AUTO-REFRESH cada 30 segundos (opcional)
setInterval(() => {
    recargarRiesgosDesdeMatriz('2-3-103');
}, 30000);
```

---

## üîÑ **FLUJO COMPLETO INTEGRADO**

### **Escenario: Especialista propone cambio y PMO agrega riesgo**

```
D√çA 1 - 10:00 AM: ESPECIALISTA PROPONE
‚îú‚îÄ‚îÄ Usuario abre WBS_Presupuestal_INTERACTIVA_v3.0.html
‚îú‚îÄ‚îÄ Ve √≠tem 2.3.103: 2,068 cajas a 300m = $2,791M
‚îú‚îÄ‚îÄ Ve criterio: "UIT-T 300m est√°ndar"
‚îú‚îÄ‚îÄ Ve 3 riesgos actuales
‚îî‚îÄ‚îÄ Click en [Proponer Cambio]

D√çA 1 - 10:05 AM: SISTEMA ANALIZA TODO
‚îú‚îÄ‚îÄ Usuario escribe: "Sugiero 500m para mejor acceso vehicular"
‚îú‚îÄ‚îÄ Click en [Generar An√°lisis]
‚îú‚îÄ‚îÄ Sistema calcula:
‚îÇ   ‚úÖ Criterios t√©cnicos (4 criterios analizados)
‚îÇ   ‚úÖ Impacto otros √≠tems (2 √≠tems recalculados)
‚îÇ   ‚úÖ Riesgos por alternativa (3 alternativas √ó 2-3 riesgos c/u)
‚îÇ   ‚úÖ Archivos afectados (5 archivos listados)
‚îÇ   ‚úÖ Recomendaci√≥n (Alternativa 2: 8.5/10)
‚îî‚îÄ‚îÄ Muestra an√°lisis completo en pantalla

D√çA 1 - 10:15 AM: USUARIO ENV√çA APROBACI√ìN
‚îú‚îÄ‚îÄ Usuario revisa an√°lisis completo
‚îú‚îÄ‚îÄ Click en [Enviar para Aprobaci√≥n PMO]
‚îî‚îÄ‚îÄ Sistema genera: DT-FIBRA-001_v1.0.md + AC-FIBRA-001_An√°lisis_v1.0.md

D√çA 2 - 9:00 AM: PMO REVISA (EN TERMINAL)
‚îú‚îÄ‚îÄ PMO abre: II/Decisiones_Tecnicas/AC-FIBRA-001_An√°lisis_v1.0.md
‚îú‚îÄ‚îÄ Revisa an√°lisis
‚îî‚îÄ‚îÄ Identifica riesgo adicional no considerado

D√çA 2 - 9:15 AM: PMO AGREGA RIESGO (TERMINAL)
‚îú‚îÄ‚îÄ PMO edita: VIII/Matrices_Dependencias/MATRIZ_RIESGOS_PMO_AMPLIADA_v1.0.md
‚îú‚îÄ‚îÄ Agrega fila:
‚îÇ   R-FIBRA-009 | Validaci√≥n OTDR no realizada puede generar fallas posteriores
‚îÇ   Origen_Decisi√≥n: DT-FIBRA-001
‚îÇ   Hito_Verificaci√≥n: H-FIBRA-005
‚îú‚îÄ‚îÄ Guarda archivo
‚îî‚îÄ‚îÄ Ejecuta: scripts/sincronizar_riesgos_wbs.ps1

D√çA 2 - 9:16 AM: INTERFAZ DETECTA CAMBIO
‚îú‚îÄ‚îÄ WBS Interactiva ejecuta auto-refresh (30 seg despu√©s)
‚îú‚îÄ‚îÄ Lee: riesgos_cache/riesgos_item_2-3-103.json
‚îú‚îÄ‚îÄ Detecta nuevo riesgo: R-FIBRA-009
‚îî‚îÄ‚îÄ Actualiza interfaz: "3 riesgos" ‚Üí "4 riesgos" üîÑ

D√çA 2 - 9:20 AM: ESPECIALISTA VE ACTUALIZACI√ìN
‚îú‚îÄ‚îÄ Especialista refresca p√°gina WBS
‚îú‚îÄ‚îÄ Ve nuevo riesgo R-FIBRA-009 con badge "NUEVO"
‚îú‚îÄ‚îÄ Lee descripci√≥n del riesgo agregado por PMO
‚îî‚îÄ‚îÄ Decide si ajustar propuesta o mantenerla

D√çA 2 - 10:00 AM: DECISI√ìN FINAL
‚îú‚îÄ‚îÄ PMO aprueba DT-FIBRA-001 ‚Üí v2.0
‚îú‚îÄ‚îÄ Sistema ejecuta cambios (Cursor)
‚îî‚îÄ‚îÄ Actualiza 5 archivos + agrega riesgos a matriz
```

---

## üìÅ **ARCHIVOS DEL SISTEMA BIDIRECCIONAL**

### **Interfaz (Front-end):**
```
IX. WBS y Planificacion/
‚îú‚îÄ‚îÄ WBS_Presupuestal_INTERACTIVA_v3.0.html ‚≠ê (Interfaz principal)
‚îú‚îÄ‚îÄ WBS_Presupuestal_AMPLIADA_v3.0.md (Markdown con columnas ampliadas)
‚îî‚îÄ‚îÄ riesgos_cache/ (JSONs generados)
    ‚îú‚îÄ‚îÄ riesgos_item_2-3-103.json
    ‚îú‚îÄ‚îÄ riesgos_item_3-1-100.json
    ‚îî‚îÄ‚îÄ [M√°s por cada √≠tem modificable]
```

### **Datos (Backend):**
```
VIII. Documentos Maestros y Metodologia/Matrices_Dependencias/
‚îú‚îÄ‚îÄ MATRIZ_RIESGOS_PMO_AMPLIADA_v1.0.md (Fuente de verdad)
‚îú‚îÄ‚îÄ MATRIZ_DEPENDENCIAS_DOCUMENTALES_v1.0.md (Archivos afectados)
‚îî‚îÄ‚îÄ [Matrices maestras]
```

### **Scripts (Sincronizaci√≥n):**
```
scripts/ (Nueva carpeta)
‚îú‚îÄ‚îÄ sincronizar_riesgos_wbs.ps1 (Matriz ‚Üí JSON)
‚îú‚îÄ‚îÄ generar_dt_desde_observacion.ps1 (Observaci√≥n ‚Üí DT)
‚îî‚îÄ‚îÄ ejecutar_cambio_aprobado.ps1 (DT aprobada ‚Üí Archivos)
```

---

## üéØ **VENTAJAS DEL SISTEMA BIDIRECCIONAL**

### **Para Usuario Final (Especialista):**
- ‚úÖ Ve TODO el an√°lisis integrado (no solo costos)
- ‚úÖ Ve riesgos actualizados en tiempo real
- ‚úÖ Propone cambios con an√°lisis autom√°tico
- ‚úÖ Ve impacto completo antes de aprobar

### **Para PMO (Terminal):**
- ‚úÖ Actualiza riesgos desde terminal
- ‚úÖ Cambios se reflejan en interfaz autom√°ticamente
- ‚úÖ Mantiene control desde archivos MD
- ‚úÖ Sin duplicaci√≥n de trabajo

### **Para Sistema:**
- ‚úÖ Fuente de verdad: Archivos MD en VIII/
- ‚úÖ Interfaz: Lee desde JSONs generados
- ‚úÖ Sincronizaci√≥n: Scripts PowerShell
- ‚úÖ Trazabilidad: 100% completa

---

## üìä **ESTADO ACTUAL**

| Componente | Estado | Observaciones |
|:-----------|:-------|:--------------|
| **WBS Interactiva HTML** | ‚úÖ Creada | Analiza TODO (criterios, impactos, riesgos, archivos) |
| **An√°lisis completo** | ‚úÖ Implementado | 6 secciones de an√°lisis autom√°tico |
| **Sistema bidireccional** | üîÑ Dise√±ado | Falta crear scripts PowerShell |
| **JSONs de riesgos** | ‚è≥ Pendiente | Requiere script de sincronizaci√≥n |
| **Auto-refresh** | ‚è≥ Pendiente | Implementar lectura desde JSON |

---

## üöÄ **PR√ìXIMOS PASOS**

### **Completar sistema bidireccional:**

1. **Crear carpeta scripts/**
   ```bash
   mkdir scripts
   ```

2. **Crear script sincronizaci√≥n:**
   ```
   scripts/sincronizar_riesgos_wbs.ps1
   ```

3. **Crear carpeta cach√©:**
   ```bash
   mkdir "IX. WBS y Planificacion/riesgos_cache"
   ```

4. **Implementar auto-refresh en HTML:**
   - Funci√≥n fetch() para leer JSONs
   - Timer para auto-actualizar cada 30 seg

5. **Probar flujo completo:**
   - Especialista propone cambio
   - PMO agrega riesgo desde terminal
   - Interfaz detecta y muestra nuevo riesgo

---

**‚úÖ AN√ÅLISIS COMPLETO IMPLEMENTADO**
**üîÑ SISTEMA BIDIRECCIONAL DISE√ëADO**
**‚è≥ SCRIPTS DE SINCRONIZACI√ìN PENDIENTES**

---

**Elaborado por:** Administrador Contractual EPC  
**Fecha:** 7 de Octubre de 2025  
**Estado:** ‚úÖ Interfaz funcional - Sincronizaci√≥n por implementar  
**Metodolog√≠a:** Punto 42 v5.0  

